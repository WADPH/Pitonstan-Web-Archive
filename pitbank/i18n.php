<?php
// i18n bootstrap: cookie + GET param ?lang=en|ru|az
// Default language is EN. Cookie persists for 1 year.
$languages = ['en','ru','az'];
$lang = 'en';
if (!empty($_GET['lang']) && in_array($_GET['lang'], $languages, true)) {
    $lang = $_GET['lang'];
    setcookie('lang', $lang, time() + 365*24*60*60, '/', '', false, true);
} elseif (!empty($_COOKIE['lang']) && in_array($_COOKIE['lang'], $languages, true)) {
    $lang = $_COOKIE['lang'];
}

// Translation map
$dict = [
    'en' => [
        'site_title' => 'PitBank Main',
        'nav_my_account' => 'My Account',
        'nav_about' => 'About',
        'nav_more' => 'More',
        'nav_live_chat' => 'Live Chat',
        'nav_private_chat' => 'Private Chat',
        'nav_sign_out' => 'Sign Out',
        'lang_en' => 'EN', 'lang_ru' => 'RU', 'lang_az' => 'AZ',
        'welcome' => 'Welcome',
        'account_balance' => 'Account Balance',
        'view_details' => 'View Details',
        'quick_actions' => 'Quick Actions',
        'transfer_money' => 'Transfer Money',
        'pay_bills' => 'Pay Bills',
        'recent_transactions' => 'Recent Transactions',
        'tx_transfer' => 'Transfer',
        'tx_salary' => 'Salary',
        'tx_payment' => 'Payment',
        'special_offers' => 'Special Offers',
        'premium_credit_card' => 'Premium Credit Card',
        'cashback_line' => '5% Cashback on all purchases',
        'learn_more' => 'Learn More',
        'exchange_rates' => 'Exchange Rates',
        'usd' => 'USD', 'eur' => 'EUR',
        'footer_about' => 'About PitBank',
        'footer_products' => 'Products',
        'footer_support' => 'Support',
        'footer_legal' => 'Legal',
        'footer_contact' => 'Contact',
        'footer_about_text' => 'A modern fictional bank platform for demos and training.',
        'footer_products_list' => 'Accounts, Cards, Loans, Investments',
        'footer_support_list' => 'Help Center, Security, API Docs, Status',
        'footer_legal_list' => 'Terms, Privacy, Cookies, Licenses',
        'footer_contact_list' => 'Email, Phone, Branches',
        'footer_rights' => 'All rights reserved',
        'theme_toggle' => 'Theme',
        'light' => 'Light',
        'dark' => 'Dark',
        // add to 'en' login.php
        'sign_in'=>'Sign In','registration'=>'Registration',
        'email'=>'Email','password'=>'Password','repeat_password'=>'Repeat Password','name'=>'Name',
        'create_account'=>'Create Account','your_email_ph'=>'Your email','name_ph'=>'Example: Samir','email_ph'=>'Example: samir@mail.pit',
        'error'=>'Error',
        // about.php
        'about_page_title' => 'PitBank About',
        'about_title' => 'About our Bank',
        'about_intro_1' => 'PitIndustrial Corp. operates Pitonstan State Bank — PitBank.',
        'about_intro_2' => 'We deliver fair conditions nationwide, from microloans to credits over 50,000ῥ.',
        'about_intro_3' => 'Open and manage your account fully online. Registration takes two clicks.',
        'services_title' => 'What you can do with PitBank',
        'service_view' => 'View account and statements',
        'service_deposit' => 'Deposit and top up',
        'service_transfer' => 'Transfer money domestically',
        'service_more' => 'Pay bills and more',
        'partnerships_title' => 'Partnerships',
        'partner_piton_airlines' => 'Piton Airlines: co-branded miles cards',
        'partner_piton_tv' => 'PitonTV: subscription cashback',
        'partner_piton_shop' => 'PitonShop: BNPL pilot program',
        'careers_title' => 'Careers',
        'careers_blurb' => 'We build secure financial products for millions. Join us.',
        'careers_open_roles' => 'Open roles',
        'role_junior_php' => 'Junior PHP Developer',
        'role_frontend' => 'Frontend Engineer (React)',
        'role_secops' => 'Security Operations Analyst',
        'careers_benefits' => 'Benefits: paid leave, learning budget, hybrid work',
        'careers_cta' => 'Send your CV',
        'certs_title' => 'Certificates & Compliance',
        'certs_blurb' => 'We align with industry standards to protect client data.',
        'cert_iso' => 'ISO 27001-aligned ISMS',
        'cert_pci' => 'PCI-DSS processes for card data',
        'cert_gdpr' => 'GDPR-ready data practices',
        'stats_title' => 'By the numbers',
        'stats_customers' => 'Customers',
        'stats_uptime' => 'Uptime last 12 months',
        'stats_branches' => 'City branches',
        'cta_open_account' => 'Open an account',
        'cta_contact' => 'Contact sales',
        'hq_photo_alt' => 'PitBank Headquarters',
        // en accounts.php
        'profile_page_title'=>'PitBank Profile',
        'profile_title'=>'Profile',
        'registration_date'=>'Registration Date',
        'full_name'=>'Full Name',
        'email'=>'Email',
        'current_balance'=>'Current Balance',
        'account_id'=>'Account ID',
        'change_password'=>'Change Password',
        'quick_actions'=>'Quick actions',
        'qa_download_statement'=>'Download statement',
        'qa_manage_devices'=>'Manage devices',
        'qa_update_profile'=>'Update profile',
        'security_title'=>'Security & Settings',
        'sec_2fa'=>'Two-factor authentication',
        'sec_2fa_status_on'=>'Enabled',
        'sec_2fa_status_off'=>'Disabled',
        'sec_last_login'=>'Last login',
        'sec_active_sessions'=>'Active sessions',
        'sec_manage'=>'Manage security',
        'limits_title'=>'Limits & KYC',
        'limit_monthly'=>'Monthly transfer limit',
        'kyc_status'=>'KYC status',
        'kyc_verified'=>'Verified',
        'kyc_unverified'=>'Not verified',
        'kyc_upgrade'=>'Upgrade KYC',
        'activity_title'=>'Recent activity',
        'activity_view_all'=>'View all',
        'activity_deposit'=>'Deposit',
        'activity_withdrawal'=>'Withdrawal',
        'activity_transfer'=>'Transfer',
        'order_new_card' => 'Buy new card',
        'coming_soon' => 'Coming soon',
        'virtual_card' => 'Virtual card',
        'spending_analytics' => 'Spending analytics',
        'mobile_payments' => 'Mobile payments',
        // en chat.php
        'chat_page_title' => 'PitBank Chat',
        'chat_title' => 'PitBank Live Chat',
        'chat_placeholder' => 'Type your message...',
        'chat_send' => 'Send',
        'chat_refresh' => 'Refresh messages',
        // en private_chat.php
        'dm_page_title'=>'PitBank — Direct Messages',
        'dm_choose_user'=>'Choose user for private chat',
        'dm_back_to_list'=>'Back to user list',
        'dm_with'=>'Chat with',
        'dm_placeholder'=>'Your message...',
        'dm_send'=>'Send',
        'dm_refresh'=>'Refresh messages'
    ],
    'ru' => [
        'site_title' => 'PitBank Главная',
        'nav_my_account' => 'Мой счёт',
        'nav_about' => 'О нас',
        'nav_more' => 'Ещё',
        'nav_live_chat' => 'Живой чат',
        'nav_private_chat' => 'Приватный чат',
        'nav_sign_out' => 'Выход',
        'lang_en' => 'EN', 'lang_ru' => 'RU', 'lang_az' => 'AZ',
        'welcome' => 'Добро пожаловать',
        'account_balance' => 'Баланс счёта',
        'view_details' => 'Подробнее',
        'quick_actions' => 'Быстрые действия',
        'transfer_money' => 'Перевод',
        'pay_bills' => 'Оплата счетов',
        'recent_transactions' => 'Недавние операции',
        'tx_transfer' => 'Перевод',
        'tx_salary' => 'Зарплата',
        'tx_payment' => 'Платёж',
        'special_offers' => 'Спецпредложения',
        'premium_credit_card' => 'Премиальная карта',
        'cashback_line' => '5% кешбэк на все покупки',
        'learn_more' => 'Узнать больше',
        'exchange_rates' => 'Курсы валют',
        'usd' => 'USD', 'eur' => 'EUR',
        'footer_about' => 'О PitBank',
        'footer_products' => 'Продукты',
        'footer_support' => 'Поддержка',
        'footer_legal' => 'Правовая информация',
        'footer_contact' => 'Контакты',
        'footer_about_text' => 'Современная демонстрационная банковская платформа.',
        'footer_products_list' => 'Счета, Карты, Кредиты, Инвестиции',
        'footer_support_list' => 'Центр помощи, Безопасность, API, Статус',
        'footer_legal_list' => 'Условия, Конфиденциальность, Cookies, Лицензии',
        'footer_contact_list' => 'Почта, Телефон, Отделения',
        'footer_rights' => 'Все права защищены',
        'theme_toggle' => 'Тема',
        'light' => 'Светлая',
        'dark' => 'Тёмная',
        // add to 'ru'
        'sign_in'=>'Вход','registration'=>'Регистрация',
        'email'=>'Почта','password'=>'Пароль','repeat_password'=>'Повторите пароль','name'=>'Имя',
        'create_account'=>'Создать аккаунт','your_email_ph'=>'Ваша почта','name_ph'=>'Пример: Samir','email_ph'=>'Пример: samir@mail.pit',
        'error'=>'Ошибка',
        // ru about.php
        'about_page_title' => 'О PitBank',
        'about_title' => 'О нашем банке',
        'about_intro_1' => 'PitIndustrial Corp. управляет Государственным банком Питонстана — PitBank.',
        'about_intro_2' => 'Мы предлагаем честные условия по всей стране: от микрокредитов до сумм свыше 50 000ῥ.',
        'about_intro_3' => 'Все операции доступны онлайн. Регистрация — в два клика.',
        'services_title' => 'Возможности PitBank',
        'service_view' => 'Просмотр счёта и выписок',
        'service_deposit' => 'Пополнение и депозиты',
        'service_transfer' => 'Переводы внутри страны',
        'service_more' => 'Оплата счетов и другое',
        'partnerships_title' => 'Партнёрства',
        'partner_piton_airlines' => 'Piton Airlines: ко-брендовые карты с милями',
        'partner_piton_tv' => 'PitonTV: кешбэк на подписку',
        'partner_piton_shop' => 'PitonShop: пилот рассрочки BNPL',
        'careers_title' => 'Карьера',
        'careers_blurb' => 'Мы создаём безопасные финпродукты для миллионов. Присоединяйтесь.',
        'careers_open_roles' => 'Открытые позиции',
        'role_junior_php' => 'Junior PHP-разработчик',
        'role_frontend' => 'Frontend-инженер (React)',
        'role_secops' => 'Аналитик Security Operations',
        'careers_benefits' => 'Бонусы: отпуск, бюджет на обучение, гибридный формат',
        'careers_cta' => 'Отправить резюме',
        'certs_title' => 'Сертификаты и соответствие',
        'certs_blurb' => 'Мы выстраиваем процессы в соответствии со стандартами отрасли.',
        'cert_iso' => 'ISMS по ISO 27001',
        'cert_pci' => 'Процессы PCI-DSS для карт',
        'cert_gdpr' => 'Практики в духе GDPR',
        'stats_title' => 'В цифрах',
        'stats_customers' => 'Клиенты',
        'stats_uptime' => 'Аптайм за 12 мес.',
        'stats_branches' => 'Филиалы',
        'cta_open_account' => 'Открыть счёт',
        'cta_contact' => 'Связаться с отделом продаж',
        'hq_photo_alt' => 'Штаб-квартира PitBank',
        // ru accounts.php
        'profile_page_title'=>'Профиль PitBank',
        'profile_title'=>'Профиль',
        'registration_date'=>'Дата регистрации',
        'full_name'=>'Полное имя',
        'email'=>'Почта',
        'current_balance'=>'Текущий баланс',
        'account_id'=>'ID счёта',
        'change_password'=>'Сменить пароль',
        'quick_actions'=>'Быстрые действия',
        'qa_download_statement'=>'Скачать выписку',
        'qa_manage_devices'=>'Управление устройствами',
        'qa_update_profile'=>'Обновить профиль',
        'security_title'=>'Безопасность и настройки',
        'sec_2fa'=>'Двухфакторная аутентификация',
        'sec_2fa_status_on'=>'Включена',
        'sec_2fa_status_off'=>'Выключена',
        'sec_last_login'=>'Последний вход',
        'sec_active_sessions'=>'Активные сессии',
        'sec_manage'=>'Управлять безопасностью',
        'limits_title'=>'Лимиты и KYC',
        'limit_monthly'=>'Месячный лимит переводов',
        'kyc_status'=>'Статус KYC',
        'kyc_verified'=>'Подтверждён',
        'kyc_unverified'=>'Не подтверждён',
        'kyc_upgrade'=>'Повысить уровень KYC',
        'activity_title'=>'Недавняя активность',
        'activity_view_all'=>'Показать всё',
        'activity_deposit'=>'Пополнение',
        'activity_withdrawal'=>'Списание',
        'activity_transfer'=>'Перевод',
        'order_new_card' => 'Купить новую карту',
        'coming_soon' => 'Скоро',
        'virtual_card' => 'Виртуальная карта',
        'spending_analytics' => 'Аналитика расходов',
        'mobile_payments' => 'Мобильные платежи',
         // ru chat.php
        'chat_page_title' => 'Чат PitBank',
        'chat_title' => 'Онлайн-чат PitBank',
        'chat_placeholder' => 'Напишите сообщение...',
        'chat_send' => 'Отправить',
        'chat_refresh' => 'Обновить сообщения',
        // ru private_chat.php
        'dm_page_title'=>'PitBank — Личные сообщения',
        'dm_choose_user'=>'Выберите пользователя для приватного чата',
        'dm_back_to_list'=>'Назад к списку пользователей',
        'dm_with'=>'Чат с',
        'dm_placeholder'=>'Ваше сообщение...',
        'dm_send'=>'Отправить',
        'dm_refresh'=>'Обновить сообщения'
            ],
    'az' => [
        'site_title' => 'PitBank Ana səhifə',
        'nav_my_account' => 'Hesabım',
        'nav_about' => 'Haqqımızda',
        'nav_more' => 'Daha çox',
        'nav_live_chat' => 'Canlı Çat',
        'nav_private_chat' => 'Şəxsi Çat',
        'nav_sign_out' => 'Çıxış',
        'lang_en' => 'EN', 'lang_ru' => 'RU', 'lang_az' => 'AZ',
        'welcome' => 'Xoş gəldiniz',
        'account_balance' => 'Hesab qalığı',
        'view_details' => 'Ətraflı bax',
        'quick_actions' => 'Sürətli əməliyyatlar',
        'transfer_money' => 'Pul köçür',
        'pay_bills' => 'Hesabları ödə',
        'recent_transactions' => 'Son əməliyyatlar',
        'tx_transfer' => 'Köçürmə',
        'tx_salary' => 'Maaş',
        'tx_payment' => 'Ödəniş',
        'special_offers' => 'Xüsusi təkliflər',
        'premium_credit_card' => 'Premium kredit kartı',
        'cashback_line' => 'Bütün alışlara 5% keşbek',
        'learn_more' => 'Daha çox',
        'exchange_rates' => 'Valyuta məzənnələri',
        'usd' => 'USD', 'eur' => 'EUR',
        'footer_about' => 'PitBank haqqında',
        'footer_products' => 'Məhsullar',
        'footer_support' => 'Dəstək',
        'footer_legal' => 'Hüquqi məlumat',
        'footer_contact' => 'Əlaqə',
        'footer_about_text' => 'Tədris və demo üçün müasir bank platforması.',
        'footer_products_list' => 'Hesablar, Kartlar, Kreditlər, İnvestisiya',
        'footer_support_list' => 'Kömək mərkəzi, Təhlükəsizlik, API, Status',
        'footer_legal_list' => 'Şərtlər, Məxfilik, Kukilər, Lisenziyalar',
        'footer_contact_list' => 'E-poçt, Telefon, Filiallar',
        'footer_rights' => 'Bütün hüquqlar qorunur',
        'theme_toggle' => 'Mövzu',
        'light' => 'Açıq',
        'dark' => 'Tünd',
        // add to 'az'
        'sign_in'=>'Daxil ol','registration'=>'Qeydiyyat',
        'email'=>'Email','password'=>'Şifrə','repeat_password'=>'Şifrəni təkrarlayın','name'=>'Ad',
        'create_account'=>'Hesab yarat','your_email_ph'=>'Email ünvanınız','name_ph'=>'Nümunə: Samir','email_ph'=>'Nümunə: samir@mail.pit',
        'error'=>'Xəta',
        // az about.php
        'about_page_title' => 'PitBank Haqqında',
        'about_title' => 'Bankımız haqqında',
        'about_intro_1' => 'PitIndustrial Corp. — Pitonstan Dövlət Bankı PitBank-ı idarə edir.',
        'about_intro_2' => 'Ölkə üzrə ədalətli şərtlər: mikrokreditlərdən 50 000ῥ üzərinə qədər.',
        'about_intro_3' => 'Bütün xidmətlər onlayndır. Qeydiyyat iki kliklə.',
        'services_title' => 'PitBank imkanları',
        'service_view' => 'Hesab və çıxarışlara baxış',
        'service_deposit' => 'Depozit və balans artırma',
        'service_transfer' => 'Ölkədaxili köçürmələr',
        'service_more' => 'Hesabların ödənilməsi və daha çox',
        'partnerships_title' => 'Tərəfdaşlıqlar',
        'partner_piton_airlines' => 'Piton Airlines: millik kartlar',
        'partner_piton_tv' => 'PitonTV: abunəyə keşbek',
        'partner_piton_shop' => 'PitonShop: BNPL pilotu',
        'careers_title' => 'Karyera',
        'careers_blurb' => 'Milyonlar üçün təhlükəsiz maliyyə məhsulları yaradırıq. Bizə qoşul.',
        'careers_open_roles' => 'Açıq vakansiyalar',
        'role_junior_php' => 'Junior PHP Developer',
        'role_frontend' => 'Frontend Engineer (React)',
        'role_secops' => 'Security Operations Analyst',
        'careers_benefits' => 'İmtiyazlar: məzuniyyət, təhsil büdcəsi, hibrid iş',
        'careers_cta' => 'CV göndər',
        'certs_title' => 'Sertifikat və uyğunluq',
        'certs_blurb' => 'Müştəri məlumatlarını qorumaq üçün standartlara uyğunlaşırıq.',
        'cert_iso' => 'ISO 27001-ə uyğun ISMS',
        'cert_pci' => 'Kart məlumatları üçün PCI-DSS prosesləri',
        'cert_gdpr' => 'GDPR yönümlü təcrübələr',
        'stats_title' => 'Rəqəmlərlə',
        'stats_customers' => 'Müştəri',
        'stats_uptime' => '12 ayın iş rejimi',
        'stats_branches' => 'Filial',
        'cta_open_account' => 'Hesab aç',
        'cta_contact' => 'Satışla əlaqə',
        'hq_photo_alt' => 'PitBank Baş ofis',
        // az accounts.php
        'profile_page_title'=>'PitBank Profil',
        'profile_title'=>'Profil',
        'registration_date'=>'Qeydiyyat tarixi',
        'full_name'=>'Tam ad',
        'email'=>'Email',
        'current_balance'=>'Cari balans',
        'account_id'=>'Hesab ID',
        'change_password'=>'Şifrəni dəyiş',
        'quick_actions'=>'Sürətli əməliyyatlar',
        'qa_download_statement'=>'Çıxarışı yüklə',
        'qa_manage_devices'=>'Cihazları idarə et',
        'qa_update_profile'=>'Profilə düzəliş et',
        'security_title'=>'Təhlükəsizlik və tənzimləmələr',
        'sec_2fa'=>'İki mərhələli təsdiq',
        'sec_2fa_status_on'=>'Aktivdir',
        'sec_2fa_status_off'=>'Söndürülübdür',
        'sec_last_login'=>'Son giriş',
        'sec_active_sessions'=>'Aktiv sessiyalar',
        'sec_manage'=>'Təhlükəsizliyi idarə et',
        'limits_title'=>'Limitlər və KYC',
        'limit_monthly'=>'Aylıq köçürmə limiti',
        'kyc_status'=>'KYC statusu',
        'kyc_verified'=>'Təsdiqlənib',
        'kyc_unverified'=>'Təsdiqlənməyib',
        'kyc_upgrade'=>'KYC yüksəlt',
        'activity_title'=>'Son aktivlik',
        'activity_view_all'=>'Hamısını göstər',
        'activity_deposit'=>'Depozit',
        'activity_withdrawal'=>'Çıxarış',
        'activity_transfer'=>'Köçürmə',
        'order_new_card' => 'Yeni kart al',
        'coming_soon' => 'Tezliklə',
        'virtual_card' => 'Virtual kart',
        'spending_analytics' => 'Xərclər analitikası',
        'mobile_payments' => 'Mobil ödənişlər',
        // az chat.php
        'chat_page_title' => 'PitBank Çatı',
        'chat_title' => 'PitBank Canlı Çat',
        'chat_placeholder' => 'Mesajınızı yazın...',
        'chat_send' => 'Göndər',
        'chat_refresh' => 'Mesajları yenilə',
        // az private_chat.php
        'dm_page_title'=>'PitBank — Şəxsi mesajlar',
        'dm_choose_user'=>'Şəxsi çat üçün istifadəçi seçin',
        'dm_back_to_list'=>'İstifadıçı siyahısına qayıt',
        'dm_with'=>'Çat —',
        'dm_placeholder'=>'Mesajınız...',
        'dm_send'=>'Göndər',
        'dm_refresh'=>'Mesajları yenilə'
            ],
];

$t = $dict[$lang];

// Simple helper
function __t(string $key): string {
    global $t;
    return $t[$key] ?? $key;
}
